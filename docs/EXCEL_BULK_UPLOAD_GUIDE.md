# 🎯 쇼핑몰 주문 엑셀 일괄 등록 가이드

## 개요
이 기능을 사용하면 스마트스토어, 쿠팡 등 쇼핑몰의 주문 데이터를 엑셀로 다운받아 한 번에 시스템에 등록할 수 있습니다.

## 사용 방법

### 1단계: 템플릿 다운로드
1. **출고 관리** 메뉴로 이동
2. **간편 출고 등록** 탭 클릭
3. 우측 상단의 **[엑셀 일괄 등록]** 버튼 클릭
4. 팝업에서 **[템플릿 다운로드]** 버튼 클릭
5. `출고등록_양식.xlsx` 파일 저장

### 2단계: 데이터 입력
#### 필수 입력 항목
- **상품명**: 시스템에 등록된 상품명과 정확히 일치해야 함
- **수량**: 숫자만 입력 (예: 1, 2, 3)

#### 선택 입력 항목 (권장)
- **수령인**: 고객 이름
- **연락처**: 전화번호 (예: 010-1234-5678)
- **주소**: 배송지 주소
- **배송메모**: 고객 요청사항
- **택배사**: CJ대한통운, 로젠택배 등
- **운송장번호**: 송장 번호 (사전에 발급받은 경우)

#### 예시
| 상품명 | 수량 | 수령인 | 연락처 | 주소 | 배송메모 | 택배사 | 운송장번호 |
|--------|------|--------|--------|------|----------|--------|------------|
| PLA 필라멘트 1.75mm 흰색 | 2 | 홍길동 | 010-1234-5678 | 서울시 강남구... | 경비실에 맡겨주세요 | CJ대한통운 | 123456789012 |
| ABS 필라멘트 1.75mm 검정 | 1 | 김철수 | 010-9876-5432 | 부산시 해운대구... | 부재시 연락주세요 | 로젠택배 | |

### 3단계: 파일 업로드
1. 작성한 엑셀 파일을 **드래그 앤 드롭** 또는 **클릭하여 선택**
2. 데이터 검증 진행
   - 상품명 누락: 제외하고 진행할지 확인
   - 수량 누락: 제외하고 진행할지 확인
3. 업로드 완료 후 결과 확인
   - 성공: XX건
   - 실패: XX건 (콘솔에서 에러 확인 가능)

### 4단계: 출고 대기 주문 확인
1. 자동으로 **출고 이력 조회** 탭으로 이동
2. 상태 필터가 **PENDING**으로 자동 설정됨
3. 업로드된 주문 목록 확인

### 5단계: 출고 확정 (재고 차감)
1. 출고 대기 중인 주문 **상세보기** 클릭
2. 우측 상단의 **[출고 확정]** 버튼 클릭
3. **출고 창고** 선택
4. **[확정 (재고차감)]** 버튼 클릭
5. 재고가 자동으로 차감되고 상태가 **SHIPPED**로 변경됨

## 주의사항

### ⚠️ 상품명 매칭
- 엑셀의 **상품명**은 시스템에 등록된 상품명과 **완전히 일치**해야 합니다
- 대소문자, 띄어쓰기까지 정확히 일치해야 함
- 더 정확한 매칭을 원하시면 SKU를 사용하세요 (추후 업데이트 예정)

### ⚠️ 재고 확인
- 엑셀 업로드 시에는 재고가 차감되지 **않습니다**
- **출고 확정** 버튼을 눌러야 실제 재고가 차감됩니다
- 재고가 부족한 경우 출고 확정이 거부됩니다

### ⚠️ 고객 정보
- 연락처를 기준으로 기존 고객을 자동으로 찾습니다
- 없으면 새로운 고객으로 자동 등록됩니다
- 고객 정보는 **판매 관리 > 고객 관리**에서 확인 가능

## 자주 묻는 질문 (FAQ)

### Q1: 업로드 후 재고가 차감되지 않아요
**A**: 정상입니다. 엑셀 업로드 시에는 "출고 대기(PENDING)" 상태로만 등록됩니다. 재고 차감은 **출고 확정** 버튼을 눌러야 진행됩니다.

### Q2: 상품을 찾을 수 없다고 나와요
**A**: 엑셀의 상품명이 시스템에 등록된 상품명과 정확히 일치하는지 확인하세요. 띄어쓰기, 대소문자까지 모두 일치해야 합니다.

### Q3: 운송장 번호는 필수인가요?
**A**: 아니요. 나중에 **판매 관리 > 주문/배송 관리**에서 추가할 수 있습니다.

### Q4: 한 번에 몇 건까지 업로드 가능한가요?
**A**: 기술적으로는 제한이 없으나, 안정성을 위해 **500건 이하**로 나누어 업로드하는 것을 권장합니다.

### Q5: 실패한 건은 어떻게 확인하나요?
**A**: 업로드 완료 후 브라우저 **콘솔(F12 > Console)**에서 상세 에러 내역을 확인할 수 있습니다.

## 팁 💡

### 효율적인 작업 흐름
1. **쇼핑몰에서 주문 다운로드** (스마트스토어, 쿠팡 등)
2. **데이터 정제**
   - 상품명을 시스템 상품명과 일치시키기
   - 불필요한 컬럼 제거
3. **템플릿에 복사/붙여넣기**
4. **일괄 업로드**
5. **출고 이력에서 확인 후 일괄 확정**

### 택배사 발송 전
- 운송장 번호 없이 업로드
- 출고 대기 상태로 보관
- 택배 접수 후 송장 번호 추가

### 택배사 발송 후
- 운송장 번호까지 함께 업로드
- 즉시 출고 확정
- 고객에게 배송 안내

## 문제 해결

### 엑셀 파일이 업로드되지 않아요
- 파일 형식 확인: `.xlsx` 또는 `.xls`만 가능
- 파일 크기 확인: 10MB 이하 권장
- 브라우저 새로고침 후 재시도

### 일부 데이터만 성공했어요
- 실패한 건은 상품명 또는 필수 항목 누락이 원인입니다
- 콘솔에서 에러 확인 후 해당 데이터만 다시 업로드하세요

---

**추가 도움이 필요하시면 관리자에게 문의하세요.**
